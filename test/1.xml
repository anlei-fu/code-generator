<?xml version="1.0" encoding="utf-8" ?>
<config>
  <table name="FC_Order_Main">
    <fields>
      <field pname="OrderNo" name="Order_No" label="订单号"/>
      <field pname="DownOrderNo" name="Down_Order_No" label="下游订单号"/>
      <field pname="DownChannelNo" name="Down_Channel_No" label="下游渠道编号"/>
      <field pname="DownProductNo" name="Down_Product_No" label="下游产品编码"/>
      <field pname="DownProductId" name="Down_Product_Id" label="下游产品ID"/>
      <field pname="ProductName" name="Product_Name" label="产品名称"/>
      <field pname="ProductType" name="Product_Type" label="产品类型"/>
      <field pname="PackageId" name="Package_Id" label="套餐编号;0:所有"/>
      <field pname="CarrierNo" name="Carrier_No" label="运营商"/>
      <field pname="ProvinceNo" name="Province_No" label="省份;QG:全国"/>
      <field pname="CityNo" name="City_No" label="城市:*:全市"/>
      <field pname="ActivePhone" name="Active_Phone" label="激活手机号"/>
      <field pname="OldPhone" name="Old_Phone" label="未办理成功的手机号"/>
      <field pname="Face" name="Face" label="面值"/>
      <field pname="PayFee" name="Pay_Fee" label="支付金额"/>
      <field pname="TradeFee" name="Trade_Fee" label="交易手续费"/>
      <field pname="BuyCntr" name="Buy_Cntr" label="数量"/>
      <field pname="TrialDay" name="Trial_Day" label="试用期"/>
      <field pname="AutoActive" name="Auto_Active" label="是否自动激活"/>
      <field pname="RequestTime" name="Request_Time" label="请求时间"/>
      <field pname="OrderTimeout" name="Order_Timeout" label="订单超时时间"/>
      <field pname="OrderStatus" name="Order_Status" label="订单状态"/>
      <field pname="RefundStatus" name="Refund_Status" label="退款状态"/>
      <field pname="RefundTime" name="Refund_Time" label="退款时间"/>
      <field pname="ActiveStatus" name="Active_Status" label="激活状态0:转正/激活90:未转正/未激活"/>
      <field pname="ActiveTime" name="Active_Time" label="激活时间"/>
      <field pname="ActiveTimeout" name="Active_Timeout" label="激活超时时间"/>
      <field pname="NotifyStatus" name="Notify_Status" label="通知状态"/>
      <field pname="ErrorCode" name="Error_Code" label="错误码"/>
      <field pname="ErrorMsg" name="Error_Msg" label="错误消息"/>
      <field pname="ScanId" name="Scan_Id" label="扫描批次"/>
      <field pname="BindIp" name="Bind_Ip" label="绑定IP"/>
      <field pname="NextBindTime" name="Next_Bind_Time" label="下次绑定时间"/>
      <field pname="FinishTime" name="Finish_Time" label="订单完成时间"/>
      <field pname="Remark" name="Remark" label="备注"/>
      <field pname="Ext1" name="Ext1" label="优先级"/>
      <field pname="Ext2" name="Ext2" label="商家备注"/>
      <field pname="Action" name="ACTION" label="当前操作"/>
      <field pname="FlowId" name="FLOW_ID" label="流程编号"/>
      <field pname="FirstChargeStatus" name="First_Charge_Status" label="首充状态"/>
      <field pname="FirstChargeTime" name="First_Charge_Time" label="首充时间"/>
      <field pname="FirstChargeFace" name="First_Charge_Face" label="首充面值"/>
      <field pname="ActiveMsg" name="Active_Msg" label="未激活原因"/>
      <field pname="LastTaskId" name="Last_Task_Id" label="最后执行任务编号"/>
      <field pname="NetStatus" name="Net_Status" label="在网状态"/>
      <field pname="NetUpdateTime" name="Net_Update_Time" label="在网状态更新时间"/>
    </fields>
  </table>
  <template>
    <item name="getList">
      <sql>
        <![CDATA[
            select  t.*,
                    dc.channel_name Channel,
                    syspr.province_name Province,
                    sysci.city_name City,
                    car.name Carrier,
                    pt.Type_Name Product,
                    fpp.Pkg_Name PkgName,
                    fs.step_name StepName,
                    --t2.name Active,
                    t3.name OrderState,
                    t4.name RefundState,
                    decode(t.Active_Status,'0','已激活','10','无需','90','未激活') ActiveStatus,
                    t6.name NotifyState,
                    t7.name Priority,
                    ex.buyer_address Address,
					t8.name FirstChargeStatus,
					t9.name NetStatus,
                    ex.buyer_alipay_id EXBuyerAlipay
                    from (SELECT RID
                            FROM (SELECT R.RID, ROWNUM LINENUM
                                    FROM (SELECT t.rowid RID
                                            FROM FC_Order_Main t  left join fc_order_ext ex on t.order_no = ex.order_no
                                           where 
                                           {@t.RequestTime >= to_date($ST,'YYYY-MM-DD')}
                                           {&@t.RequestTime < to_date($ET,'YYYY-MM-DD')}
                                           {&@t.OrderNo}
                                           {&@t.DownOrderNo}
                                           {&@t.DownChannelNo}
                                           {&@t.DownProductId}
                                           {&@t.DownProductNo}
                                           {&@t.CarrierNo}
                                           {&@t.ProvinceNo}
                                           {&@t.Face}
                                           {&@t.OrderStatus}
                                           {&@t.RefundStatus}
                                           {&@t.ActiveStatus}
                                           {&@t.NotifyStatus}
                                           {&@t.FirstChargeStatus}
                                           {&@t.NetStatus}										   
                                           {&@t.ProductType}
                                           {&@t.Ext1}
                                           {&:Memo}
                                           {&:ActiveIdno}
                                           and ({@t.OldPhone} or {@t.ActivePhone})
                                           order by t.request_time desc) R
                                   WHERE ROWNUM <= { :PS} * { :PI})
                           WHERE LINENUM > { :PS} * ({ :PI} - 1)) tab
                   inner join FC_Order_Main t on tab.rid = t.rowid
                   left join fc_order_ext ex on t.order_no = ex.order_no
                   left join fc_down_channel dc on t.down_channel_no = dc.channel_no
                   left join fc_system_province syspr on t.province_no = syspr.province_no
                   left join fc_system_city sysci on t.city_no = sysci.city_no
                   left join fc_system_dictionary car on t.carrier_no = car.value and car.type = 'Carrier'
                   left join FC_Product_Type pt on t.product_type = pt.Type_Id
                   left join FC_Product_Package fpp on t.Package_Id = fpp.Pkg_Id
                   left join fc_flow_step fs on t.FLOW_ID = fs.fid and t.action = fs.action
                   --left join fc_system_dictionary t2 on t.auto_active = t2.value and t2.type = 'IsTure'
                   left join fc_system_dictionary t3 on t.order_status = t3.value and t3.type = 'OrderStatus'
                   left join fc_system_dictionary t4 on t.refund_status = t4.value and t4.type = 'RefundStatus'
                   
                   left join fc_system_dictionary t6 on t.notify_status = t6.value and t6.type = 'NotifyStatus'
                   left join fc_system_dictionary t7 on t.ext1 = t7.value and t7.type = 'Priority'
				   left join fc_system_dictionary t8 on t.first_charge_status = t8.value and t8.type = 'FirstChargeStatus'
				   left join fc_system_dictionary t9 on t.net_status = t9.value and t9.type = 'NetStatus'
				   
                   order by t.request_time desc
        ]]>
      </sql>
    </item>
    <item name="getCount">
      <sql>
        <![CDATA[
          select count(1) from FC_Order_Main t  left join fc_order_ext ex on t.order_no = ex.order_no              
                                           where 
                                           {@t.RequestTime >= to_date($ST,'YYYY-MM-DD')}
                                           {&@t.RequestTime < to_date($ET,'YYYY-MM-DD')}
                                           {&@t.OrderNo}
                                           {&@t.DownOrderNo}
                                           {&@t.DownChannelNo}
                                           {&@t.CarrierNo}
                                           {&@t.ProvinceNo}
                                           {&@t.Face}
                                           {&@t.OrderStatus}
                                           {&@t.RefundStatus}
                                           {&@t.DownProductId}
                                           {&@t.DownProductNo}
                                           {&@t.ActiveStatus}
                                           {&@t.NotifyStatus}
										   {&@t.FirstChargeStatus}
                                           {&@t.NetStatus}	
                                           {&@t.ProductType}
                                           {&@t.Ext1}
                                           {&:Memo}
                                           {&:ActiveIdno}
                                           and ({@t.OldPhone} or {@t.ActivePhone})
        ]]>
      </sql>
    </item>

   
    <item name="getExecl">
      <sql>
        <![CDATA[
         select  t.Down_Order_No ,
                 ex.Tmall_Order_Date TmallOrderTime,
                 ex.buyer_nick EXBuyerNick,
                 ex.active_idno EXIDNO,
                 t.active_phone,
                 ex.buyer_phone EXBuyTel,
                 ex.buyer_message EXMsg,
                 ex.buyer_address EXAddress,
                 ex.buyer_phone EXBuyTel,
                 t.pay_fee,
                 ex.active_real_name EXREALName,
                 t.down_product_no,
                 dc.channel_name DChannel,
                 t.remark,
                 t.Ext2,
                 decode(p.predeposit, 0, '否', '是') IsPrede,
                 sd.name SDPriority,
                 ex.iccno ICCID,
                 ex.buyer_name BuyerName,
                 t.order_no,
                 sd1.name OrderState,
                 t.Product_Name,
                 syspr.province_name Province,
                 sysci.city_name City,
                 t.request_time,
                 t.Error_Msg,
                 ex.tmall_status TmallStatus,
                 decode(t.Active_Status,'0','已激活','10','无需','90','未激活') activestatusname,
                 decode(t.first_charge_status,'0','已首充','10','无需','90','未首充') chargestatusname,
                 decode(t.net_status,'0','在网','10','无需','90','不在网') netstatusname,				 
                 t.Active_Time,
                 t.Active_Msg,
                 t.First_Charge_Time,
                 t.First_Charge_Face,
                 p.month_rent  MonthRent,
                 pt.Type_Name Product
                 
            FROM FC_Order_Main t
            left join fc_order_ext ex on t.order_no = ex.order_no
             left join fc_system_province syspr on t.province_no = syspr.province_no
            left join fc_system_city sysci on t.city_no = sysci.city_no
            left join fc_down_channel dc on t.down_channel_no = dc.channel_no
            left join fc_product_package p on t.package_id = p.pkg_id
            left join fc_system_dictionary sd on t.ext1 = sd.value and sd.type = 'Priority'
            left join fc_system_dictionary sd1 on t.order_status = sd1.value and sd1.type = 'OrderStatus'
            left join FC_Product_Type pt on t.product_type = pt.Type_Id
                     where 
                     {@t.RequestTime >= to_date($ST,'YYYY-MM-DD')}
                     {&@t.RequestTime < to_date($ET,'YYYY-MM-DD')}
                     {&@t.OrderNo}
                     {&@t.DownOrderNo}
                     {&@t.DownChannelNo}
                     {&@t.CarrierNo}
                     {&@t.ProvinceNo}
                     {&@t.Face}
                     {&@t.DownProductId}
                     {&@t.DownProductNo}
                     {&@t.OrderStatus}
                     {&@t.RefundStatus}
                     {&@t.ActiveStatus}
                     {&@t.NotifyStatus}
					 {&@t.FirstChargeStatus}
                     {&@t.NetStatus}	
                     {&@t.ProductType}
                     {&@t.Ext1}
                     {&:Memo}
                     {&:ActiveIdno}         
                     and ({@t.OldPhone} or {@t.ActivePhone})
                     order by t.request_time desc
        ]]>
      </sql>
    </item>

    <item name="getDetails">
      <sql>
        <![CDATA[
          select    t.*,
                    ex.order_no EXOrder,
                    ex.buyer_name EXBuyerName,
                    ex.ACTIVE_IDNO EXBuyerId,
                    ex.ACTIVE_REAL_NAME EXRealName,
                    ex.brand_no EXBrandNo,
                    ex.buyer_nick EXBuyerNick,
                    ex.buyer_alipay_id EXBuyerAlipay,
                    ex.pay_order_no EXPayOrderNo,
                    ex.buyer_phone EXBuyerPhone,
                    ex.buyer_address EXBuyerAddress,
                    ex.buyer_message EXBuyerMsg,
                    ex.ICCNO EXSimno,
                    ex.tmall_status EXTmallState,
                    ex.tmall_order_date EXTmallOrderDate,
                    ex.install_address EXInstallAdd,
                    dc.channel_name Channel,
                    syspr.province_name Province,
                    sysci.city_name City,
                    car.name Carrier,
                    pt.Type_Name Product,
                    fpp.Pkg_Name PkgName,
                    ff.flow_name FlowName,
                    t2.name Active,
                    t3.name OrderState,
                    t4.name RefundState,
                    t5.name ActiveState,
                    t6.name NotifyState,
					t11.name NetStatus,
                    t7.name TypeAction,
                    t8.name TmallOrder,
                    t9.name EXWriteCard,
                    t10.name Priority,
                    ex.ext_info EXExtInfo,
                    sysprstr.province_name ExProvince,
                    syscistr.city_name ExCity,
                    t.action_no ActionNo,
                 decode(t.Active_Status,'0','已激活','10','无需','90','未激活') activestatusname,
                 decode(t.first_charge_status,'0','已首充','10','无需','90','未首充') chargestatusname
                     FROM FC_Order_Main t
                     left join fc_order_ext ex on t.order_no = ex.order_no
                     left join fc_down_channel dc on t.down_channel_no = dc.channel_no
                     left join fc_system_province syspr on t.province_no = syspr.province_no
                     left join fc_system_city sysci on t.city_no = sysci.city_no
                     left join fc_system_province sysprstr on ex.buyer_province = sysprstr.province_no
                     left join fc_system_city syscistr on ex.buyer_city = syscistr.city_no
                     left join fc_system_dictionary car on t.carrier_no = car.value and car.type = 'Carrier'
                     left join FC_Product_Type pt on t.product_type = pt.Type_Id
                     left join FC_Product_Package fpp on t.Package_Id = fpp.Pkg_Id
                     left join fc_flow ff on t.flow_id = ff.fid
                     left join fc_system_dictionary t2 on t.auto_active = t2.value and t2.type = 'IsTure'
                     left join fc_system_dictionary t3 on t.order_status = t3.value and t3.type = 'OrderStatus'
                     left join fc_system_dictionary t4 on t.refund_status = t4.value and t4.type = 'RefundStatus'
                     left join fc_system_dictionary t5 on t.active_status = t5.value and t5.type = 'ActiveStatus'
                     left join fc_system_dictionary t6 on t.notify_status = t6.value and t6.type = 'NotifyStatus'
                     left join fc_system_dictionary t7 on t.action = t7.value and t7.type = 'ActionType'
                     left join fc_system_dictionary t8 on ex.Tmall_Status = t8.value and t8.type = 'OrderStatus'
                     left join fc_system_dictionary t9 on ex.WRITE_CARD = t9.value and t9.type = 'Write_Card_Mode'
                     left join fc_system_dictionary t10 on t.ext1 = t10.value and t10.type = 'Priority'
                     left join fc_system_dictionary t11 on t.net_status = t11.value and t11.type = 'NetStatus'
					 
                     where 
                     {@t.OrderNo}
        ]]>
      </sql>
    </item>
    <item name="GetSingCount">
      <sql>
        <![CDATA[
          select count(1) from FC_Order_Main t left join fc_order_ext ex on t.order_no = ex.order_no       where 
                                           {@t.RequestTime >= to_date($ST,'YYYY-MM-DD')}
                                           {&@t.RequestTime < to_date($ET,'YYYY-MM-DD')}
                                           {&@t.OrderNo}
                                           {&@t.DownOrderNo}
                                           {&@t.DownChannelNo}
                                           {&@t.CarrierNo}
                                           {&@t.ProvinceNo}
                                           {&@t.Face}
                                           {&@t.OrderStatus}
                                           {&@t.RefundStatus}
                                           {&@t.ActiveStatus}
                                           {&@t.NotifyStatus}
										   {&@t.FirstChargeStatus}
                                           {&@t.NetStatus}	
                                           {&@t.ProductType}
                                           {&:ActiveIdno}    
                                           and ({@t.OldPhone} or {@t.ActivePhone})
        ]]>
      </sql>
    </item>
    <item name="GetSingOrder">
      <sql>
        <![CDATA[
            select  t.*,
                    dc.channel_name Channel,
                    syspr.province_name Province,
                    sysci.city_name City,
                    car.name Carrier,
                    pt.Type_Name Product,
                    fpp.Pkg_Name PkgName,
                    fs.step_name StepName,
                    --t2.name Active,
                    t3.name OrderState,
                    t4.name RefundState,
                    t5.name ActiveState,
                    t6.name NotifyState        
                    from (SELECT RID
                            FROM (SELECT R.RID, ROWNUM LINENUM
                                    FROM (SELECT t.rowid RID
                                            FROM FC_Order_Main t left join fc_order_ext ex on t.order_no = ex.order_no      
                                           where 
                                           {@t.RequestTime >= to_date($ST,'YYYY-MM-DD')}
                                           {&@t.RequestTime < to_date($ET,'YYYY-MM-DD')}
                                           {&@t.OrderNo}
                                           {&@t.DownOrderNo}
                                           {&@t.DownChannelNo}
                                           {&@t.CarrierNo}
                                           {&@t.ProvinceNo}
                                           {&@t.Face}
                                           {&@t.OrderStatus}
                                           {&@t.RefundStatus}
                                           {&@t.ActiveStatus}
										                       {&@t.FirstChargeStatus}
                                           {&@t.NetStatus}	
                                           {&@t.NotifyStatus}
                                           {&@t.ProductType}
                                           {&:ActiveIdno}    
                                           and ({@t.OldPhone} or {@t.ActivePhone})
                                           order by t.request_time desc) R
                                   WHERE ROWNUM <= { :PS} * { :PI})
                           WHERE LINENUM > { :PS} * ({ :PI} - 1)) tab
                   inner join FC_Order_Main t on tab.rid = t.rowid
                   left join fc_down_channel dc on t.down_channel_no = dc.channel_no
                   left join fc_system_province syspr on t.province_no = syspr.province_no
                   left join fc_system_city sysci on t.city_no = sysci.city_no
                   left join fc_system_dictionary car on t.carrier_no = car.value and car.type = 'Carrier'
                   left join FC_Product_Type pt on t.product_type = pt.Type_Id
                   left join FC_Product_Package fpp on t.Package_Id = fpp.Pkg_Id
                   left join fc_flow_step fs on t.FLOW_ID = fs.fid and t.action = fs.action
                   --left join fc_system_dictionary t2 on t.auto_active = t2.value and t2.type = 'IsTure'
                   left join fc_system_dictionary t3 on t.order_status = t3.value and t3.type = 'OrderStatus'
                   left join fc_system_dictionary t4 on t.refund_status = t4.value and t4.type = 'RefundStatus'
                   left join fc_system_dictionary t5 on t.active_status = t5.value and t5.type = 'ActiveStatus'
                   left join fc_system_dictionary t6 on t.notify_status = t6.value and t6.type = 'NotifyStatus'
                   order by t.request_time desc
        ]]>
      </sql>
    </item>

  
    
    
    <item name="channelMonitor">
      <sql>
      <![CDATA[
 
      with  channel as
     (select 
         t.channel_no,
         t.channel_name
      from  fc_down_channel t
      union all
    select 
         t.channel_no channel_no,
         t.channel_name
      from  fc_up_channel t)
  select 
    t2.channel_no as down_channel_no,
    t2.channel_name as down_channel_name,
    t3.channel_no as up_channel_no,
    t3.channel_name as up_channel_name,
    t4.type_id ,
    t4.type_name,
    t5.step_name,
    t5.fid flow_id,
    t5.action,
    count(1) as total
  from fc_order_main t
  inner join fc_flow_task t1
  on t.order_no =t1.order_no
  left join channel  t2 on t.down_channel_no =t2.channel_no
  left join channel  t3 on t1.up_channel_no =t3.channel_no
  left join fc_product_type t4 on t.product_type =t4.type_id
  left join fc_flow_step t5 on t.flow_id =t5.fid and t.action=t5.action
  where t.order_status=30 
  and t1.task_status  = 30
  group by  t2.channel_name,t3.channel_name,t4.type_name,t2.channel_no,t3.channel_no,t4.type_id,t5.step_name,t5.fid,t5.action
      ]]>
      </sql>
    </item>
    <item name="channelMonitorDetailList">
      <sql>
        <![CDATA[
            select  t.*,
                    dc.channel_name Channel,
                    syspr.province_name Province,
                    sysci.city_name City,
                    car.name Carrier,
                    pt.Type_Name Product,
                    fpp.Pkg_Name PkgName,
                    fs.step_name StepName,
                    --t2.name Active,
                    t3.name OrderState,
                    t4.name RefundState,
                    decode(t.Active_Status,'0','已激活','10','无需','90','未激活') ActiveStatus,
                    t6.name NotifyState,
                    t7.name Priority,
                    ex.buyer_address Address,
					t8.name FirstChargeStatus,
					t9.name NetStatus,
                    ex.buyer_alipay_id EXBuyerAlipay
                    from (SELECT RID
                            FROM (SELECT R.RID, ROWNUM LINENUM
                                    FROM (SELECT t.rowid RID
                                            FROM FC_Order_Main t 
                                            inner join fc_flow_task t1
                                             on t.order_no =t1.order_no
                                           where  t.order_status=30 
                                                  and t1.task_status  = 30
                                                  and {:up_channel}
                                                  and {:down_channel}
                                                  and {:product_type}
                                                  and {:action}
                                                  and {:flow}
                                           order by t.request_time desc) R
                                   WHERE ROWNUM <= { :PS} * { :PI})
                           WHERE LINENUM > { :PS} * ({ :PI} - 1)) tab
                   inner join FC_Order_Main t on tab.rid = t.rowid
                   left join fc_order_ext ex on t.order_no = ex.order_no
                   left join fc_down_channel dc on t.down_channel_no = dc.channel_no
                   left join fc_system_province syspr on t.province_no = syspr.province_no
                   left join fc_system_city sysci on t.city_no = sysci.city_no
                   left join fc_system_dictionary car on t.carrier_no = car.value and car.type = 'Carrier'
                   left join FC_Product_Type pt on t.product_type = pt.Type_Id
                   left join FC_Product_Package fpp on t.Package_Id = fpp.Pkg_Id
                   left join fc_flow_step fs on t.FLOW_ID = fs.fid and t.action = fs.action
                   --left join fc_system_dictionary t2 on t.auto_active = t2.value and t2.type = 'IsTure'
                   left join fc_system_dictionary t3 on t.order_status = t3.value and t3.type = 'OrderStatus'
                   left join fc_system_dictionary t4 on t.refund_status = t4.value and t4.type = 'RefundStatus'
                   
                   left join fc_system_dictionary t6 on t.notify_status = t6.value and t6.type = 'NotifyStatus'
                   left join fc_system_dictionary t7 on t.ext1 = t7.value and t7.type = 'Priority'
				           left join fc_system_dictionary t8 on t.first_charge_status = t8.value and t8.type = 'FirstChargeStatus'
				           left join fc_system_dictionary t9 on t.net_status = t9.value and t9.type = 'NetStatus'
        ]]>
      </sql>
    </item>
    <item name="channelMonitorCount">
      <sql>
        <![CDATA[
          select count(1) from FC_Order_Main t  
          inner join fc_flow_task t1
          on t.order_no =t1.order_no
          where  t.order_status=30 
                 and t1.task_status  = 30
                 and {:up_channel_no}
                 and {:down_channel_no}
                 and {:product_type}
                 and {:action}
                 and {:flow}
        ]]>
      </sql>
    </item>

    <item name="refundMonitor">
      <sql>
        <![CDATA[
        with  channel as
     (select 
         t.channel_no,
         t.channel_name
      from  fc_down_channel t
      union all
    select 
         t.channel_no channel_no,
         t.channel_name
      from  fc_up_channel t)
  select 
    t2.channel_no as down_channel_no,
    t2.channel_name as down_channel_name,
    t3.channel_no as up_channel_no,
    t3.channel_name as up_channel_name,
    t4.type_id ,
    t4.type_name,
    count(1) as total
  from fc_order_main t
  inner join fc_flow_task t1
  on t.order_no =t1.order_no
  left join channel  t2 on t.down_channel_no =t2.channel_no
  left join channel  t3 on t1.up_channel_no =t3.channel_no
  left join fc_product_type t4 on t.product_type =t4.type_id
  where t.order_status=50 
  and t.refund_status =20
  and t1.task_status  = 50
  group by t2.channel_name,t3.channel_name,t4.type_name,t2.channel_no,t3.channel_no,t4.type_id
  
      ]]>
      </sql>
    </item>
    <item name="refundMonitorDetailList">
      <sql>
        <![CDATA[
            select  t.*,
                    dc.channel_name Channel,
                    syspr.province_name Province,
                    sysci.city_name City,
                    car.name Carrier,
                    pt.Type_Name Product,
                    fpp.Pkg_Name PkgName,
                    fs.step_name StepName,
                    --t2.name Active,
                    t3.name OrderState,
                    t4.name RefundState,
                    decode(t.Active_Status,'0','已激活','10','无需','90','未激活') ActiveStatus,
                    t6.name NotifyState,
                    t7.name Priority,
                    ex.buyer_address Address,
					t8.name FirstChargeStatus,
					t9.name NetStatus,
                    ex.buyer_alipay_id EXBuyerAlipay
                    from (SELECT RID
                            FROM (SELECT R.RID, ROWNUM LINENUM
                                    FROM (SELECT t.rowid RID
                                            FROM FC_Order_Main t 
                                            inner join fc_flow_task t1
                                             on t.order_no =t1.order_no
                                           where  t.order_status=50 
                                                  and t.refund_status =20
                                                  and {:up_channel}
                                                  and {:down_channel}
                                                  and {:product_type}
                                           order by t.request_time desc) R
                                   WHERE ROWNUM <= { :PS} * { :PI})
                           WHERE LINENUM > { :PS} * ({ :PI} - 1)) tab
                   inner join FC_Order_Main t on tab.rid = t.rowid
                   left join fc_order_ext ex on t.order_no = ex.order_no
                   left join fc_down_channel dc on t.down_channel_no = dc.channel_no
                   left join fc_system_province syspr on t.province_no = syspr.province_no
                   left join fc_system_city sysci on t.city_no = sysci.city_no
                   left join fc_system_dictionary car on t.carrier_no = car.value and car.type = 'Carrier'
                   left join FC_Product_Type pt on t.product_type = pt.Type_Id
                   left join FC_Product_Package fpp on t.Package_Id = fpp.Pkg_Id
                   left join fc_flow_step fs on t.FLOW_ID = fs.fid and t.action = fs.action
                   --left join fc_system_dictionary t2 on t.auto_active = t2.value and t2.type = 'IsTure'
                   left join fc_system_dictionary t3 on t.order_status = t3.value and t3.type = 'OrderStatus'
                   left join fc_system_dictionary t4 on t.refund_status = t4.value and t4.type = 'RefundStatus'
                   
                   left join fc_system_dictionary t6 on t.notify_status = t6.value and t6.type = 'NotifyStatus'
                   left join fc_system_dictionary t7 on t.ext1 = t7.value and t7.type = 'Priority'
				           left join fc_system_dictionary t8 on t.first_charge_status = t8.value and t8.type = 'FirstChargeStatus'
				           left join fc_system_dictionary t9 on t.net_status = t9.value and t9.type = 'NetStatus'
        ]]>
      </sql>
    </item>
    <item name="refundMonitorCount">
      <sql>
        <![CDATA[
          select count(1) from FC_Order_Main t  
          inner join fc_flow_task t1
          on t.order_no =t1.order_no
          where  t.order_status=50 
                 and t.refund_status =20
                 and {:up_channel_no}
                 and {:down_channel_no}
                 and {:product_type}
        ]]>
      </sql>
    </item>
    
  </template>
</config>