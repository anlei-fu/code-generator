<?xml version="1.0" encoding="utf-8" ?>
<config>
  <table name="QY_BASE_DOWN_CHANNEL">
    <fields>
       <field pname="ChannelNo" name="CHANNEL_NO" label="渠道编号"/>
       <field pname="ChannelName" name="CHANNEL_NAME" label="渠道名称"/>
       <field pname="CompanyId" name="COMPANY_ID" label="所属公司"/>
       <field pname="SourceSystemId" name="SOURCE_SYSTEM_ID" label="所属系统编号"/>
       <field pname="Status" name="STATUS" label="状态"/>
       <field pname="CommiBalance" name="COMMI_BALANCE" label="佣金余额"/>
       <field pname="WarnBalance" name="WARN_BALANCE" label="报警余额"/>
       <field pname="AccountId" name="ACCOUNT_ID" label="下游账户id"/>
       <field pname="CreatedUser" name="CREATED_USER" label="创建人"/>
       <field pname="CreatedTime" name="CREATED_TIME" label="创建时间"/>
       <field pname="LastEditUser" name="LAST_EDIT_USER" label="最后更新人"/>
       <field pname="LastEditTime" name="LAST_EDIT_TIME" label="最后更新时间"/>
    </fields>
  </table>
  <template>
    <item name="getList">
      <sql>
        <![CDATA[
          SELECT 
                t.*,
                t1.DESCRIPTION StatusName,
                t2.DESCRIPTION AccountName      
          FROM 
            (SELECT RID
                  FROM (SELECT R.RID, ROWNUM LINENUM
                          FROM (SELECT t.rowid RID
                                 FROM  QY_BASE_DOWN_CHANNEL t
                                 WHERE 
                                      1=1
                                      {&@t.AccountId}
                                      {&@t.Status}
                                   ) R
                           WHERE ROWNUM <= { :PS} * { :PI})
                  WHERE LINENUM > { :PS} * ({ :PI} - 1)) tab
           INNER JOIN QY_BASE_DOWN_CHANNEL t on tab.rid = t.rowid
           LEFT JOIN FD_SYSTEM_DICTIONARY t1 ON t.STATUS = t1.VALUE AND t1.BELONG_ENUM = 'Status'
           LEFT JOIN ACCOUNT t2 ON t.ACCOUNT_ID = t2.ACCOUNT_Id
 
        ]]>
      </sql>
    </item>
    <item name="getCount">
      <sql>
        <![CDATA[
            SELECT 
                  COUNT(1) 
            FROM QY_BASE_DOWN_CHANNEL  t  
            WHERE 
                 1=1
                 {&@t.AccountId}
                 {&@t.Status}                                      
        ]]>
      </sql>
    </item>
<item name="exportExcel">
        <sql>
          <![CDATA[
            SELECT 
                  t.*,
                  t1.CHANNEL_NAME ChannelName,
                  t2.ACCOUNT_NAME AccountName,
                  t3.NAME ChangeTypeName      
            FROM  QY_BASE_DOWN_CHANNEL t
            WHERE 
                                      1=1
                                      {&@t.AccountId}
                                      {&@t.Status}
           LEFT JOIN FD_SYSTEM_DICTIONARY t1 ON t.STATUS = t1.VALUE AND t1.BELONG_ENUM = 'Status'
           LEFT JOIN ACCOUNT t2 ON t.ACCOUNT_ID = t2.ACCOUNT_ID
  
          ]]>
        </sql>
      </item>
  </template>
</config>