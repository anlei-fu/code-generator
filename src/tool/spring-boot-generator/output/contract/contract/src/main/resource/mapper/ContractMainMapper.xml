<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.contract.mapper.ContractMainMapper">
    <insert id="addContractMain" parameterType="com.contract.pojo.req.AddContractMainReq">
          insert  into contract_main t
          <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="contractPrice != null">
                  t.contract_price,
            </if>
            <if test="contractState != null">
                  t.contract_state,
            </if>
            <if test="contractTitle != null">
                  t.contract_title,
            </if>
            <if test="contractType != null">
                  t.contract_type,
            </if>
            <if test="effectTime != null">
                  t.effect_time,
            </if>
            <if test="expireTime != null">
                  t.expire_time,
            </if>
            <if test="rawContractFile != null">
                  t.raw_contract_file,
            </if>
            <if test="rawContractHash != null">
                  t.raw_contract_hash,
            </if>
            <if test="signContractFile != null">
                  t.sign_contract_file,
            </if>
            <if test="signContractHash != null">
                  t.sign_contract_hash,
            </if>
            <if test="signExpireTime != null">
                  t.sign_expire_time,
            </if>
            <if test="userId != null">
                  t.user_id,
            </if>
            <if test="validPeriod != null">
                  t.valid_period,
            </if>
             t.create_time
          </trim>
          values
          <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="contractPrice != null">
                  #{contractPrice},
            </if>
            <if test="contractState != null">
                  #{contractState},
            </if>
            <if test="contractTitle != null">
                  #{contractTitle},
            </if>
            <if test="contractType != null">
                  #{contractType},
            </if>
            <if test="effectTime != null">
                  #{effectTime},
            </if>
            <if test="expireTime != null">
                  #{expireTime},
            </if>
            <if test="rawContractFile != null">
                  #{rawContractFile},
            </if>
            <if test="rawContractHash != null">
                  #{rawContractHash},
            </if>
            <if test="signContractFile != null">
                  #{signContractFile},
            </if>
            <if test="signContractHash != null">
                  #{signContractHash},
            </if>
            <if test="signExpireTime != null">
                  #{signExpireTime},
            </if>
            <if test="userId != null">
                  #{userId},
            </if>
            <if test="validPeriod != null">
                  #{validPeriod},
            </if>
             current_timestamp
          </trim>
    </insert>
    <delete id="deleteContractMainById">
          delete from contract_main t
          <where>
            <if test="id != null">
                  t.id = #{id}
            </if>
          </where>
    </delete>
    <update id="updateContractMainById" parameterType="com.contract.pojo.param.UpdateContractMainByIdParams">
        update contract_main t
        <set>
            <if test="contractPrice != null">
                  t.contract_price = #{ContractPrice},
            </if>
            <if test="contractState != null">
                  t.contract_state = #{ContractState},
            </if>
            <if test="contractTitle != null">
                  t.contract_title = #{ContractTitle},
            </if>
            <if test="contractType != null">
                  t.contract_type = #{ContractType},
            </if>
            <if test="effectTime != null">
                  t.effect_time = #{EffectTime},
            </if>
            <if test="expireTime != null">
                  t.expire_time = #{ExpireTime},
            </if>
            <if test="rawContractFile != null">
                  t.raw_contract_file = #{RawContractFile},
            </if>
            <if test="rawContractHash != null">
                  t.raw_contract_hash = #{RawContractHash},
            </if>
            <if test="signContractFile != null">
                  t.sign_contract_file = #{SignContractFile},
            </if>
            <if test="signContractHash != null">
                  t.sign_contract_hash = #{SignContractHash},
            </if>
            <if test="signExpireTime != null">
                  t.sign_expire_time = #{SignExpireTime},
            </if>
            <if test="userId != null">
                  t.user_id = #{UserId},
            </if>
            <if test="validPeriod != null">
                  t.valid_period = #{ValidPeriod}
            </if>
        </set>
          <where>
            <if test="id != null">
                  t.id = #{id}
            </if>
          </where>
    </update>
    <select id="getContractMainById" resultType="com.contract.pojo.entity.ContractMain">
          select
             t.contract_price,
             t.contract_state,
             t.contract_title,
             t.contract_type,
             t.create_time,
             t.effect_time,
             t.expire_time,
             t.id,
             t.raw_contract_file,
             t.raw_contract_hash,
             t.sign_contract_file,
             t.sign_contract_hash,
             t.sign_expire_time,
             t.user_id,
             t.valid_period
          form contract_main t
          <where>
            <if test="id != null">
                  t.id = #{id}
            </if>
          </where>
    </select>
    <select id="getContractMainList" resultType="com.contract.pojo.entity.ContractMain" parameterType="com.contract.pojo.req.GetContractMainListReq">
          select
             t.contract_price,
             t.contract_state,
             t.contract_title,
             t.contract_type,
             t.create_time,
             t.effect_time,
             t.expire_time,
             t.id,
             t.raw_contract_file,
             t.raw_contract_hash,
             t.sign_contract_file,
             t.sign_contract_hash,
             t.sign_expire_time,
             t.user_id,
             t.valid_period
          form contract_main t
          <where>
            <if test="contractPrice != null">
                  t.contract_price = #{contractPrice}
            </if>
            <if test="contractState != null">
                  and t.contract_state = #{contractState}
            </if>
            <if test="contractTitle != null and contractTitle != ''">
                  and t.contract_title = #{contractTitle}
            </if>
            <if test="contractType != null">
                  and t.contract_type = #{contractType}
            </if>
            <if test="createTimeStart !=null and  createTimeEnd != null">
                  and t.create_time between #{createTimeStart} and #{createTimeEnd}
            </if>
            <if test="effectTimeStart !=null and  effectTimeEnd != null">
                  and t.effect_time between #{effectTimeStart} and #{effectTimeEnd}
            </if>
            <if test="expireTimeStart !=null and  expireTimeEnd != null">
                  and t.expire_time between #{expireTimeStart} and #{expireTimeEnd}
            </if>
            <if test="signExpireTimeStart !=null and  signExpireTimeEnd != null">
                  and t.sign_expire_time between #{signExpireTimeStart} and #{signExpireTimeEnd}
            </if>
            <if test="userId != null">
                  and t.user_id = #{userId}
            </if>
            <if test="validPeriod != null">
                  and t.valid_period = #{validPeriod}
            </if>
          </where>
    </select>
</mapper>
